{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Career Filter Form</title>
    <link rel="stylesheet" href="{% static 'css/userform.css' %}">
</head>
<body>
    <nav>
        <div class="container nav-container">
            <div class="logo">Career<span>Guide</span></div>
            <div class="nav-links">
                <a href="{% url 'profile' %}" title="Profile">Profile</a>
                <a href="{% url 'contact' %}" title="Contact"><i class="fa fa-fw fa-envelope"></i> Contact</a>
                <a href="{% url 'about' %}" title="About">About Us</a>
                {% if user.is_authenticated %}
                <a href="{% url 'logout' %}" title="Logout">Logout</a>
                {% else %}
                <a href="{% url 'userlogin' %}" title="Login">Login</a>
                {% endif %}
            </div>
        </div>
    </nav>
    <h2>Choose Your Career Preferences</h2>

    <form method="post">
        {% csrf_token %}

        <!-- Qualification -->
        <label for="qualification">Qualification:</label>
        <select name="qualification" id="qualification" required>
            <option value="">-- Select Qualification --</option>
            {% for qualification in qualifications %}
                <option value="{{ qualification.id }}">{{ qualification.name }}</option>
            {% endfor %}
        </select>

        <!-- Subject (filtered by qualification) -->
        <label for="subject">Subject:</label>
        <select name="subject" id="subject" required>
            <option value="">-- Select Subject --</option>
            {% for qualification in qualifications %}
                {% for subject in qualification.subject_set.all %}
                    <option value="{{ subject.id }}" data-qualification="{{ qualification.id }}">
                        {{ subject.name }}
                    </option>
                {% endfor %}
            {% endfor %}
        </select>

        <!-- Interested field -->
        <label for="interested">Interested In:</label>
        <select name="interested" id="interested" required>
            <option value="">-- Select Option --</option>
            <option value="Job">Job</option>
            <option value="Study">Study</option>
        </select>

        <!-- Optional details -->
        <label for="details">Extra Details (Optional):</label>
        <textarea name="details" id="details" rows="4" placeholder="Any additional information..."></textarea>

        <!-- Submit -->
        <input type="submit" value="Submit">
    </form>

    <!-- JavaScript for subject filtering -->
    <script>
        const qualificationSelect = document.getElementById("qualification");
        const subjectSelect = document.getElementById("subject");

        function filterSubjects() {
            const selectedQualification = qualificationSelect.value;
            Array.from(subjectSelect.options).forEach(option => {
                if (!option.value) return;  // Skip placeholder
                option.style.display = option.dataset.qualification === selectedQualification ? "block" : "none";
            });
            subjectSelect.value = ""; // Reset subject
        }

        qualificationSelect.addEventListener("change", filterSubjects);
        window.addEventListener("load", filterSubjects); // Apply filtering on load
    </script>
</body>
</html>
